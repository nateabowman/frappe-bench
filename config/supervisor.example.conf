# Supervisor configuration example for Frappe Bench
# Copy to supervisor.conf and customize paths for your deployment
# Replace /path/to/frappe-bench and USERNAME with your values

; priority=1 --> Lower priorities start first
; killasgroup=true --> send kill signal to child processes too

[program:frappe-bench-frappe-web]
command=/path/to/frappe-bench/env/bin/gunicorn -b 127.0.0.1:8000 -w 4 --max-requests 5000 -t 120 frappe.app:application --preload
priority=4
autostart=true
autorestart=true
stdout_logfile=/path/to/frappe-bench/logs/web.log
stderr_logfile=/path/to/frappe-bench/logs/web.error.log
user=USERNAME
directory=/path/to/frappe-bench/sites
startretries=10

[program:frappe-bench-frappe-schedule]
command=bench schedule
priority=3
autostart=true
stdout_logfile=/path/to/frappe-bench/logs/schedule.log
stderr_logfile=/path/to/frappe-bench/logs/schedule.error.log
user=USERNAME
directory=/path/to/frappe-bench
startretries=10

[program:frappe-bench-frappe-worker]
command=bench worker --queue short,default,long
priority=4
autostart=true
autorestart=true
stdout_logfile=/path/to/frappe-bench/logs/worker.log
stderr_logfile=/path/to/frappe-bench/logs/worker.error.log
user=USERNAME
directory=/path/to/frappe-bench
killasgroup=true
startretries=10

[program:frappe-bench-redis-cache]
command=redis-server /path/to/frappe-bench/config/redis_cache.conf
priority=1
autostart=true
autorestart=true
user=USERNAME
directory=/path/to/frappe-bench/sites
startretries=10

[program:frappe-bench-redis-queue]
command=redis-server /path/to/frappe-bench/config/redis_queue.conf
priority=1
autostart=true
autorestart=true
user=USERNAME
directory=/path/to/frappe-bench/sites
startretries=10

[program:frappe-bench-node-socketio]
command=node /path/to/frappe-bench/apps/frappe/socketio.js
priority=4
autostart=true
autorestart=true
user=USERNAME
directory=/path/to/frappe-bench
startretries=10
